Version 4
SHEET 1 3972 2452
WIRE 992 -128 496 -128
WIRE 1232 -128 992 -128
WIRE 496 -80 496 -128
WIRE 992 -80 992 -128
WIRE 1984 -64 1824 -64
WIRE 2128 -64 2064 -64
WIRE 2128 -32 2128 -64
WIRE 352 0 320 0
WIRE 448 0 432 0
WIRE 848 0 816 0
WIRE 944 0 928 0
WIRE 2640 32 2640 -48
WIRE 2736 32 2640 32
WIRE 2768 32 2736 32
WIRE 2960 32 2912 32
WIRE 3136 32 3104 32
WIRE 3344 32 3280 32
WIRE 3552 32 3344 32
WIRE 320 48 320 0
WIRE 816 48 816 0
WIRE 2736 64 2736 32
WIRE 1984 96 1808 96
WIRE 2128 96 2128 48
WIRE 2128 96 2064 96
WIRE 3072 96 3072 64
WIRE 3072 96 2992 96
WIRE 3072 112 3072 96
WIRE 3344 144 3344 32
WIRE 3392 144 3344 144
WIRE 3584 144 3536 144
WIRE 320 160 320 128
WIRE 496 160 496 16
WIRE 496 160 320 160
WIRE 816 160 816 128
WIRE 992 160 992 16
WIRE 992 160 816 160
WIRE 1232 176 1232 -128
WIRE 2000 176 2000 144
WIRE 2736 176 2736 144
WIRE 2848 176 2848 96
WIRE 2848 176 2736 176
WIRE 2048 208 2048 144
WIRE 2048 208 1808 208
WIRE 3216 208 3216 96
WIRE 3504 208 3504 176
WIRE 3504 208 3424 208
WIRE 3504 224 3504 208
WIRE 496 256 496 160
WIRE 576 256 496 256
WIRE 992 256 992 160
WIRE 992 256 912 256
WIRE 1968 272 1904 272
WIRE 2128 272 1968 272
WIRE 2304 272 2272 272
WIRE 2480 272 2448 272
WIRE 2640 272 2640 32
WIRE 2640 272 2624 272
WIRE 496 320 496 256
WIRE 992 320 992 256
WIRE 1904 320 1904 272
WIRE 2848 320 2848 176
WIRE 2944 320 2848 320
WIRE 3216 336 3216 288
WIRE 2784 352 2784 320
WIRE 2560 384 2560 336
WIRE 2848 384 2848 320
WIRE 352 400 320 400
WIRE 448 400 432 400
WIRE 848 400 816 400
WIRE 944 400 928 400
WIRE 2512 400 2480 400
WIRE 320 448 320 400
WIRE 816 448 816 400
WIRE 1904 448 1904 400
WIRE 2384 496 2384 336
WIRE 2848 512 2848 464
WIRE 320 560 320 528
WIRE 496 560 496 416
WIRE 496 560 320 560
WIRE 816 560 816 528
WIRE 816 560 496 560
WIRE 992 560 992 416
WIRE 992 560 816 560
WIRE 1232 560 1232 256
WIRE 1232 560 992 560
WIRE 496 592 496 560
WIRE 2000 688 1920 688
WIRE 2160 688 2080 688
WIRE 2240 688 2160 688
WIRE 2544 688 2480 688
WIRE 1920 736 1920 688
WIRE 1648 752 1648 704
WIRE 2160 752 2160 688
WIRE 2480 752 2480 688
WIRE 1648 880 1648 832
WIRE 1920 880 1920 816
WIRE 2160 880 2160 816
WIRE 2480 880 2480 832
WIRE 2560 992 2480 992
WIRE 2720 992 2640 992
WIRE 2800 992 2720 992
WIRE 2480 1040 2480 992
WIRE 2720 1056 2720 992
WIRE 1936 1072 1936 1040
WIRE 2480 1184 2480 1120
WIRE 2720 1184 2720 1120
FLAG 496 592 0
FLAG 576 256 m+
FLAG 912 256 m-
FLAG 1920 880 0
FLAG 2160 880 0
FLAG 2240 688 El_Power
FLAG 1904 448 0
FLAG 2640 -48 Torque
FLAG 1808 208 Wmech
FLAG 3552 32 Wmech
FLAG 3216 336 0
FLAG 2848 512 0
FLAG 2544 688 Shaft_Power
FLAG 2480 880 0
FLAG 2944 320 Load
FLAG 3584 144 RPM
FLAG 3072 112 0
FLAG 3504 224 0
FLAG 2000 176 0
FLAG 1968 272 Tem
FLAG 2784 352 0
FLAG 2560 464 0
FLAG 2512 448 0
FLAG 2480 400 Wmech
FLAG 1648 880 0
FLAG 1648 704 BEMF
FLAG 2128 96 Vbemf
FLAG 1936 1152 0
FLAG 1936 1040 Efficiency
FLAG 2208 464 0
FLAG 2480 1184 0
FLAG 2720 1184 0
FLAG 2800 992 Wmech_flt
FLAG 2384 576 0
FLAG 2208 336 0
FLAG 1824 -64 m+
FLAG 1808 96 m-
SYMBOL nmos 448 320 R0
SYMATTR InstName M1
SYMATTR Value BSB012N03LX3
SYMBOL res 448 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName r_g
SYMATTR Value 5
SYMBOL nmos 448 -80 R0
SYMATTR InstName M2
SYMATTR Value BSB012N03LX3
SYMBOL voltage 320 32 R0
WINDOW 3 -286 142 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 15 0 10n 10n {d1*t_pwm} {t_pwm})
SYMATTR InstName V1
SYMBOL res 448 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName r_g1
SYMATTR Value 5
SYMBOL nmos 944 320 R0
SYMATTR InstName M3
SYMATTR Value BSB012N03LX3
SYMBOL res 944 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName r_g2
SYMATTR Value 5
SYMBOL nmos 944 -80 R0
SYMATTR InstName M4
SYMATTR Value BSB012N03LX3
SYMBOL res 944 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName r_g3
SYMATTR Value 5
SYMBOL voltage 1232 160 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V_BUS
SYMATTR Value 24
SYMBOL voltage 320 432 R0
WINDOW 3 -286 142 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 15 0 10n 10n {d4*t_pwm} {t_pwm})
SYMATTR InstName V2
SYMBOL voltage 816 32 R0
WINDOW 3 -286 142 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 15 0 10n 10n {d3*t_pwm} {t_pwm})
SYMATTR InstName V3
SYMBOL voltage 816 432 R0
WINDOW 3 -286 142 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 15 0 10n 10n {d2*t_pwm} {t_pwm})
SYMATTR InstName V4
SYMBOL bv 1920 720 R0
SYMATTR InstName B1
SYMATTR Value V=(V(M+)-V(M-))*I(L2)
SYMBOL res 2096 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 5k
SYMBOL cap 2144 752 R0
SYMATTR InstName C1
SYMATTR Value 0.047µF
SYMBOL res 2112 -48 R0
SYMATTR InstName R4
SYMATTR Value {Rt}
SYMBOL ind 1968 -48 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value {L}
SYMBOL bv 1904 304 R0
WINDOW 3 44 57 Left 2
SYMATTR Value V=I(L2)*Kt
SYMATTR InstName B2
SYMBOL e 2080 96 M270
SYMATTR InstName E1
SYMATTR Value {Kemf}
SYMBOL Subtractor 2848 32 R0
SYMATTR InstName X1
SYMBOL Integrator 3216 32 R0
SYMATTR InstName X2
SYMBOL voltage 2848 368 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value PWL(0 0 0.06 0 0.061 0.2612)
SYMBOL voltage 3216 192 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value 0
SYMBOL bv 2480 736 R0
SYMATTR InstName B3
SYMATTR Value V = V(Torque) * V(Wmech)
SYMBOL Gain 3008 0 R0
WINDOW 3 -82 -41 Left 2
SYMATTR Value {1/(Jmotor + Jload)}
SYMATTR InstName E2
SYMBOL Gain 3440 112 R0
WINDOW 3 -28 32 Left 2
SYMATTR Value {30 / pi}
SYMATTR InstName E3
SYMBOL res 2720 48 R0
SYMATTR InstName R5
SYMATTR Value 1K
SYMBOL Subtractor 2384 272 R0
SYMATTR InstName X3
SYMBOL voltage 2384 480 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName Friction1
SYMATTR Value 0.0141
SYMBOL Subtractor 2560 272 R0
SYMATTR InstName X4
SYMBOL e 2560 368 R0
SYMATTR InstName E4
SYMATTR Value 1.28e-5
SYMBOL bv 1648 736 R0
SYMATTR InstName B4
SYMATTR Value V=V(Vbemf)-V(M-)
SYMBOL bv 1936 1056 R0
SYMATTR InstName B5
SYMATTR Value V=V(shaft_power) / V(el_power)*100
SYMBOL Subtractor 2208 272 R0
SYMATTR InstName X5
SYMBOL bv 2208 368 R0
WINDOW 3 -528 130 Left 2
SYMATTR Value V=if(V(Wmech_flt)<200,0,{Rt}*I(L2)**2 / V(Wmech_flt))
SYMATTR InstName B6
SYMBOL res 2656 976 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 50k
SYMBOL cap 2704 1056 R0
SYMATTR InstName C2
SYMATTR Value 0.047µF
SYMBOL bv 2480 1024 R0
SYMATTR InstName B7
SYMATTR Value V=V(Wmech)
TEXT -256 280 Left 2 !.param f_pwm=10k\n.param d1=0.1 d2=1 d3=0 d4=0\n.param t_pwm = 1/f_pwm
TEXT 3344 -136 Left 2 !.tran 0 0.5 0 1m uic
TEXT 3344 -176 Left 2 ;DC MOTOR MODEL
TEXT 1896 -160 Left 2 ;Motor Model (Pittman DC Servo Motor\nModel 14206 with 24V Winding)
TEXT 2000 544 Left 2 ;Friction\nMotor Bearings and Brushes
TEXT 2856 888 Left 2 !.param Jload=0
TEXT 2704 -168 Left 2 ;LOAD
TEXT 3504 64 Left 2 ;Radians/sec
TEXT 3016 296 Left 2 ;load\ntorque
TEXT 2856 664 Left 2 !.param Kt = 0.071
TEXT 2856 856 Left 2 !.param Jmotor = 37E-6
TEXT 2856 696 Left 2 !.param Kemf = 0.071
TEXT 3128 664 Left 2 ;Newton-Meters/Amp
TEXT 3128 696 Left 2 ;Volts/(radian/sec)
TEXT 2856 728 Left 2 !.param Kf = 0.014
TEXT 3128 728 Left 2 ;Newton-Meters
TEXT 2856 760 Left 2 !.param Kd = 13E-6
TEXT 3128 760 Left 2 ;Newton-Meters/(radian/sec)
TEXT 2856 792 Left 2 !.param Rt = 0.84
TEXT 2856 824 Left 2 !.param L = 1.36E-3
TEXT 3128 856 Left 2 ;Kilograms-Meter^2
TEXT 3128 824 Left 2 ;Henries
TEXT 3128 792 Left 2 ;Ohms
TEXT 3128 888 Left 2 ;Kilograms-Meter^2 (use 0 for no load inertia, or as an example 100E-6)
TEXT 3344 -112 Left 2 !.options method = gear
TEXT 2864 240 Left 2 ;Cut here to lock rotor
TEXT 2840 240 Left 2 ;X
TEXT 2512 512 Left 2 ;Damping
RECTANGLE Normal 2592 624 1880 -192
RECTANGLE Normal 3304 624 2696 -192
